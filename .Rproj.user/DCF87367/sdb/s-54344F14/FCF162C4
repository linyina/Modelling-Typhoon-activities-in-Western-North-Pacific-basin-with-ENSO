{
    "collab_server" : "",
    "contents" : "######################################################################################\n# In a binomial GLM, the response variable can be considered as the proportion of 'successes' \n# from a collection of Bernoulli trials.\n#\n# A GLM can be thought of as a regression-like model, that can be used in a variety of \n# situations where the distributions of the responses given the covariates are non-normal.\n\n# In a GAM, the smoothing parameter can be chosen automatically by trying to predict new \n# observations as accurately as possible.\n\n# In a binomial GLM, the link function should usually be chosen to map the interval (0,1) to the entire real line.\n\n#  For many GLMs, accurate prediction intervals cannot be calculated easily.\n\n############################ Galapagos\n\n# According to model galapagos.glm1, what is the expected number of endemic species on \n# an island with an area of 0.06 km2 ? \n# Calculate this as accurately as possible, and give your answer to three decimal places. \n\npredict(galapagos.glm1, newdata=data.frame(Area=0.06), type=\"response\") \n\n# When you plot the number of endemics against the island area using log scales for both axes, \n# you get a warning message. \n# What is the area of the island causing this warning? Give your answer to two decimal places.\n\ngalapagos.data[galapagos.data$Endemics<=0,]\n\n\n# Fit a new quasiPoisson GLM which is the same as galapagos.glm4 \n# but with the interaction term removed, and obtain a summary of this new model. \n# According to the summary table, which if any of the remaining terms \n# could possibly be dropped at conventional levels of statistical significance?\n\ngalapagos.glm5<- update(galapagos.glm2, .~. + Adjacent)  # NEAREST\nsummary(galapagos.glm5)\n\n#In the script Galapagos_GLMs.r you fitted three different Poisson GLMs. \n#Which of them is preferred according to their AIC values?\n\ngalapagos.glm1$aic\ngalapagos.glm2$aic\ngalapagos.glm3$aic\n\n\n# In model galapagos.glm4, by how much does the deviance reduce when the Nearest:Adjacent \n# term is added to a model containing log(Area) and Nearest and Adjacent? \n# Give your answer to two decimal places. \nanova(galapagos.glm4)\n\n# What is the estimated variance of the Pearson residuals from galapagos.glm1? \n# Give your answer to three decimal places. \nsum( resid(galapagos.glm1,type=\"pearson\")^2 ) / galapagos.glm1$df.residual\n\n\n\n\n###  Beetle\n\n# Fit a binomial GLM with a logit link function, relating the proportion of \n# deaths to the logarithm of CS2 dose. What is the value of the, \n# linear predictor in your fitted model when the log dose is 1.76 units? \n# Calculate this as accurately as possible, and give your answer to three decimal places.\n\nsummary(beetle.glm) # then calculate by hand\npredict(beetle.glm, newdata=data.frame(logdose=1.76)) \n\n# Fit a binomial GLM with a logit link function, relating the proportion of deaths \n# to the logarithm of CS2 dose. According to your model, what is the probability \n# that a beetle will die when the log dose is 1.72 units? Calculate this as accurately as possible, and give your answer to three decimal places.\npredict(beetle.glm, newdata=data.frame(logdose=1.72), type = \"response\") \n\n# Fit a binomial GLM with a logit link function, relating the proportion of deaths to the logarithm of CS2 dose. \n# What is the estimated variance of the Pearson residuals from your fitted model? \n# Give your answer to three decimal places. \n\nsum( resid(beetle.glm,type=\"pearson\")^2 ) / beetle.glm$df.residual\n\n# In the logistic regression model that you fitted in the workshop, \n# by how much is the residual deviance reduced compared with the null (i.e. what is the difference between the null and residual deviances)? \n# Calculate this as accurately as possible, and give your answer to two decimal places. #272.97\n\nsummary(beetle.glm)\n\n# Fit a binomial GLM with a complementary log-log link function, \n# relating the proportion of deaths to the logarithm of CS2 dose. \n# What is the value of the, linear predictor in your fitted model when the log dose is 1.83 units? \n# Calculate this as accurately as possible, and give your answer to three decimal places. \n\nbeetle.glm2 <- glm(proportions ~ logdose, weights=totals, \n                   family=binomial(link=\"cloglog\") )\nsummary(beetle.glm2)\n\n# Fit a binomial GLM with a probit link function, relating the proportion of deaths to the \n# logarithm of CS2 dose. What is the estimated variance of the deviance residuals from your fitted model? \n# Give your answer to three decimal places. \n\nbeetle.glm3<- glm(proportions ~ logdose, weights=totals, \n                  family=binomial(link=\"probit\") )\nsum( resid(beetle.glm3,type=\"deviance\")^2 ) / beetle.glm3$df.residual\n\n\n###################### Terrorist\n# In which year did the United States experience the most terrorist attacks?\nUSAttacks[USAttacks$Freq==max(USAttacks$Freq),]\n\n\n# In the Poisson GAM that you fitted to the US terrorism attack data, \n# how many effective degrees of freedom does the estimated trend have? \n# Give your answer to two decimal places. \n\nsummary(UStrends)\n\n# According to model UStrends, what is the predicted number of terrorist attacks \n# in the United States in the year 2015? \n# Give your answer to three decimal places. \n\npredict(UStrends, newdata=data.frame(Year=2015), type=\"response\") \n\n#  Fit a quasiPoisson GAM to model the trend in terrorist attacks in Greece. \n# According to this model, how many terrorist attacks are / were expected in Greece during 2017? \n# Give your answer to 2 decimal places. \n\nwanted.rows2 <- grepl(\"Greece\",YearlyAttacks$Country, fixed = \"TRUE\")\nGreeceAttacks <- YearlyAttacks[wanted.rows2,]\nGreecetrends <- gam(Freq ~ s(Year), family=poisson(link=\"log\"),\n                data=GreeceAttacks)\nGreecetrends2 <- update(Greecetrends, family=quasipoisson(link=\"log\"),\n                    control=list(scale.est=\"pearson\"))\npredict(Greecetrends2, newdata=data.frame(Year=2017), type=\"response\") \n\n# What is the total number of terrorist attacks in the database for 'Netherlands '? \nwanted.rows3 <- grepl(\"Netherlands\",YearlyAttacks$Country)\nNAttacks<- YearlyAttacks[wanted.rows3,]\nsum(NAttacks$Freq)\n\n# What is the estimated variance of the Pearson residuals for the quasiPoisson GAM \n# that you fitted to the data for the United States? \n# Give your answer to three decimal places. \n  sum( resid(UStrends2,type=\"pearson\")^2 ) / UStrends2$df.residual  # 4.201\n\n# According to model UStrends2, what is the standard error associated with the predicted \n# logarithm of the expected number of terrorist attacks in the USA during 2011? \n# Give your answer to three decimal places. \n\npredict(UStrends2, newdata=data.frame(Year=2011), se.fit=TRUE)$se.fit\n\n\n# Fit a quasiPoisson GAM to model the trend in terrorist attacks in Peru. \n# In this model, how many effective degrees of freedom does the estimated trend have? \n# Give your answer to two decimal places. \nwanted.rows4 <- grepl(\"Peru\",YearlyAttacks$Country, fixed = TRUE)\nPAttacks <- YearlyAttacks[wanted.rows4,]\nPtrends <- gam(Freq ~ s(Year), family=poisson(link=\"log\"),\n                    data=PAttacks)\nPtrends2 <- update(Ptrends, family=quasipoisson(link=\"log\"),\n                        control=list(scale.est=\"pearson\"))\nPtrends2$edf\n\n\n# Fit a quasiPoisson GAM to model the trend in terrorist attacks in Nepal. \n# According to this model, how many terrorist attacks are / were expected in Nepal during 2019? \n# Give your answer to 2 decimal places.\n\nwanted.rows4 <- grepl(\"Nepal\",YearlyAttacks$Country, fixed = TRUE)\nPAttacks <- YearlyAttacks[wanted.rows4,]\nPtrends <- gam(Freq ~ s(Year), family=poisson(link=\"log\"),\n               data=PAttacks)\nPtrends2 <- update(Ptrends, family=quasipoisson(link=\"log\"),\n                   control=list(scale.est=\"pearson\"))\n\npredict(Ptrends2, newdata=data.frame(Year=2019), type=\"response\") \n",
    "created" : 1510532256305.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "641935759",
    "id" : "FCF162C4",
    "lastKnownWriteTime" : 1491832686,
    "last_content_update" : 1491832686,
    "path" : "E:/UCL_Study/STAT7001/Rstudio/Quiz/Workshop6.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 10,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}