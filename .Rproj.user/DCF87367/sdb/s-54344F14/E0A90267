{
    "collab_server" : "",
    "contents" : "#### 2.1 Map\n\n######\n## summary(CMABST$Latitude)\n## Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n## 0.50   14.10   19.10   20.72   25.60   60.50 \n## summary(CMABST$Longitude)\n## Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n## 95.0   122.1   132.7   134.4   145.1   226.0 \n## ylim = c(0,61), xlim = c(90, 230)\n######\nlibrary(maps)\nlibrary(mapdata)\nlibrary(lattice)\n\nif (!(names(dev.cur()) %in% c(\"windows\",\"X11cairo\"))) x11(width=8,height=6)\n\nmap('worldHires', c('China','Taiwan','Vietnam','Philippines', 'North Korea', 'South Korea', 'Japan', \n                    'Laos', 'Cambodia', 'Thailand', 'Myanmar'), ylim = c(0,61), xlim = c(90, 230),\n    mar = c(4.1, 4.1, par(\"mar\")[3], 0.1))\n\nwanted.rows <- CMABST$SerialNum == \"1949-1\"\nlines(CMABST$Longitude[wanted.rows],CMABST$Latitude[wanted.rows],col=\"blue\")\nlines(CMABST$Longitude[CMABST$SerialNum == \"1949-2\"], CMABST$Latitude[CMABST$SerialNum == \"1949-2\"], col= \"blue\")\n\n## Define a function of drawing maps to make things easier\nplot.single <- function(x){\n  if (!(names(dev.cur()) %in% c(\"windows\",\"X11cairo\"))) x11(width=8,height=6)\n  par(mar=c(5,6,4,2))\n  map('worldHires', c('China','Taiwan','Vietnam','Philippines', 'North Korea', 'South Korea', 'Japan', \n                      'Laos', 'Cambodia', 'Thailand', 'Myanmar'), ylim = c(0,61), xlim = c(90, 230),\n      mar = c(4.1, 4.1, par(\"mar\")[3], 0.1))\n  lines(x$Longitude, x$Latitude, col= rgb(0,0,0,alpha=0.3))\n}\n\nplot.single(CMABST[wanted.rows,])\n\n## a. Transparent lines for all the data on the map\n\nSerial.list <- levels(as.factor(CMABST$SerialNum))\ni = 0\n\nmap('worldHires', c('China','Taiwan','Vietnam','Philippines', 'North Korea', 'South Korea', 'Japan', \n                    'Laos', 'Cambodia', 'Thailand', 'Myanmar'), ylim = c(0,61), xlim = c(90, 230),\n    mar = c(4.1, 4.1, par(\"mar\")[3], 0.1))\n\nwhile (i <=2245){\n  i = i+1\n  wanted.data <- CMABST$SerialNum == Serial.list[i]\n  lines(CMABST$Longitude[wanted.data],CMABST$Latitude[wanted.data], col= rgb(0,0,0,alpha=0.1))\n}\n\n## Using function to make things easier\n\nplot.track<- function(x){\n  if (!(names(dev.cur()) %in% c(\"windows\",\"X11cairo\"))) x11(width=8,height=6)\n  par(mar=c(5,6,4,2))\n  plot.list <- levels(as.factor(x$SerialNum))\n  map('worldHires', c('China','Taiwan','Vietnam','Philippines', 'North Korea', 'South Korea', 'Japan', \n                      'Laos', 'Cambodia', 'Thailand', 'Myanmar'), ylim = c(0,61), xlim = c(90, 230),\n      mar = c(4.1, 4.1, par(\"mar\")[3], 0.1))\n  \n  i = 0\n  \n  while (i <=2245){\n    i = i+1\n    wanted.data <- x$SerialNum == Serial.list[i]\n    lines(CMABST$Longitude[wanted.data],CMABST$Latitude[wanted.data], col= rgb(0,0,0,alpha=0.1))\n  }\n  \n}\n\nplot.new()\nplot.track(CMABST)\ntitle(main=\"CMA tropical Cyclone tracks from 1949-2016\")\ndev.copy(pdf,\"CMABST_all_tracks_b&w.pdf\",width=8,height=6)\ndev.off()\n\n## b. Try by decades\nwanted.dec1 <- CMABST[Year<=1958,]\nwanted.dec2 <- CMABST[(Year>1958) & (Year<=1968),]\nwanted.dec3 <- CMABST[(Year>1968) & (Year<=1978),]\nwanted.dec4 <- CMABST[(Year>1978) & (Year<=1988),]\nwanted.dec5 <- CMABST[(Year>1988) & (Year<=1998),]\nwanted.dec6 <- CMABST[(Year>1998) & (Year<=2008),]\nwanted.dec7 <- CMABST[(Year>2008) & (Year<=2018),]\n\n\nplot.track(wanted.dec1) # 1949-1958\nplot.track(wanted.dec2) # 1959-1968\nplot.track(wanted.dec3) # 1969-1978\nplot.track(wanted.dec4) # 1979-1988\nplot.track(wanted.dec5) # 1989-1998\nplot.track(wanted.dec6) # 1999-2008\nplot.track(wanted.dec7) # 2008-2016\n\n\n## Try by years\nplot.track(CMABST[CMABST$Year==2016,])\n\n\n## c. By Intensity\ncol.scale<- rev(c(grey(0,alpha = 0.3), NA, NA, heat.colors(7, alpha = 0.4)))\nplot.cols<- function(x){\n  if (!(names(dev.cur()) %in% c(\"windows\",\"X11cairo\"))) x11(width=8,height=6)\n  par(mar=c(5,6,4,2))\n  map('worldHires', c('China','Taiwan','Vietnam','Philippines', 'North Korea', 'South Korea', 'Japan', \n                      'Laos', 'Cambodia', 'Thailand', 'Myanmar'), ylim = c(0,61), xlim = c(90, 230),\n      mar = c(4.1, 4.1, par(\"mar\")[3], 0.1))\n  points(x$Longitude[CMABST$Intensity==0], x$Latitude[CMABST$Intensity==0], col= col.scale[CMABST$Intensity + 1], pch=4)\n  points(x$Longitude[CMABST$Intensity==1], x$Latitude[CMABST$Intensity==1], col= col.scale[CMABST$Intensity + 1], pch=4)\n  points(x$Longitude[CMABST$Intensity==2], x$Latitude[CMABST$Intensity==2], col= col.scale[CMABST$Intensity + 1], pch=4)\n  points(x$Longitude[CMABST$Intensity==3], x$Latitude[CMABST$Intensity==3], col= col.scale[CMABST$Intensity + 1], pch=18)\n  points(x$Longitude[CMABST$Intensity==4], x$Latitude[CMABST$Intensity==4], col= col.scale[CMABST$Intensity + 1], pch=20)\n  points(x$Longitude[CMABST$Intensity==5], x$Latitude[CMABST$Intensity==5], col= col.scale[CMABST$Intensity + 1], pch=19)\n  points(x$Longitude[CMABST$Intensity==6], x$Latitude[CMABST$Intensity==6], col= col.scale[CMABST$Intensity + 1], pch=17)\n  points(x$Longitude[CMABST$Intensity==9], x$Latitude[CMABST$Intensity==9], col= col.scale[CMABST$Intensity + 1], pch=1)\n  legend(\"topright\", inset=.001, title=\"Intensity Category\", c(\"<TD\",\"TD\",\"TS\",\"STS\",\"TY\",\"STY\",\"SuperTY\",\"ET\"), \n         col = col.scale,\n         pch=c(4,4,18,20,20,19,17,1),text.width = 3,cex=0.8,horiz=FALSE)\n}\nplot.cols(CMABST[wanted.rows,])\nplot.cols(CMABST)\ntitle(main=\"CMA tropical Cyclone tracks from 1949-2016\")\ndev.copy(pdf,\"CMABST_all_tracks_col.pdf\",width=8,height=6)\ndev.off()\nplot.cols(wanted.dec1)\ndev.copy(pdf,\"CMABST_1949_1958.pdf\",width=8,height=6)\ndev.off()\nplot.cols(wanted.dec2)\ndev.copy(pdf,\"CMABST_1959_1968.pdf\",width=8,height=6)\ndev.off()\nplot.cols(wanted.dec3)\ndev.copy(pdf,\"CMABST_1969_1978.pdf\",width=8,height=6)\ndev.off()\nplot.cols(wanted.dec4)\ntitle(main=\"CMA tropical Cyclone tracks from 1979-1988\")\ndev.copy(pdf,\"CMABST_1979_1988.pdf\",width=8,height=6)\ndev.off()\nplot.cols(wanted.dec5)\ntitle(main=\"CMA tropical Cyclone tracks from 1989-1998\")\ndev.copy(pdf,\"CMABST_1989_1998.pdf\",width=8,height=6)\ndev.off()\nplot.cols(wanted.dec6)\ntitle(main=\"CMA tropical Cyclone tracks from 1999-2008\")\ndev.copy(pdf,\"CMABST_1999_2008.pdf\",width=8,height=6)\ndev.off()\nplot.cols(wanted.dec7)\ntitle(main=\"CMA tropical Cyclone tracks from 2008-2016\")\ndev.copy(pdf,\"CMABST_2009_2016.pdf\",width=8,height=6)\ndev.off()\n",
    "created" : 1510578001638.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1037239548",
    "id" : "E0A90267",
    "lastKnownWriteTime" : 1510580723,
    "last_content_update" : 1510580723851,
    "path" : "E:/UCL_Study/Project_typhoon/STAT3901 Project/Step2-1_Exp Stats_map.R",
    "project_path" : "Step2-1_Exp Stats_map.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 13,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}