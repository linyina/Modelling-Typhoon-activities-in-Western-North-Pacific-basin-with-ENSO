{
    "collab_server" : "",
    "contents" : "#######################################################\n####  2.2 Exploratory Analysis\n####\n#######################################################\nlibrary(lattice)   # heatmap and xyplot\nlibrary(ggplot2)   # time series plot\nlibrary(MASS)\nlibrary(tidyr)  # time series plot\nlibrary(RColorBrewer) # Colours\nlibrary(reshape2) # melt\n########################\nif (!(names(dev.cur()) %in% c(\"windows\",\"X11cairo\"))) x11(width=8,height=6)\n\n## Part 1: Landfall Data\n## a. Reconstruct data\n\n## a.1: Cleaning\nland.clean<- Landfall\nland.clean[is.na(land.clean$`Total Times of Landfall`),]$`Total Times of Landfall` <- 0\nland.clean$TC.freq <- rep(1, length(land.clean$Year))\nland.clean[is.na(land.clean$`Serial Number`),]$`Serial Number` <- \"000\"\nland.clean$`Landfall Intensity Category`<-as.factor(land.clean$`Landfall Intensity Category`)\n\nland.clean$`Landfall Intensity Category` <- factor(land.clean$`Landfall Intensity Category`,\n                                                   levels = c(\"\",\"TD\",\n                                                              \"TS\",\"STS\",\"TY\", \n                                                              \"STY\",\"SuperTY\"))\nlevels(land.clean$`Landfall Intensity Category`)\nlevels(land.clean$`Landfall Intensity Category`)<-c(0:6)\nland.clean$`Landfall Intensity Category`<- as.numeric(as.character(land.clean$`Landfall Intensity Category`))\nland.clean[is.na(land.clean$`Landfall Intensity Category`),]$`Landfall Intensity Category`<- 0\nstr(land.clean)\n\n## a.2: Landfall Frequency\nlf.temp<- data.frame(Year=rep(1949:2016, each=15), \n                          Province= rep(levels(Landfall$`Landfall Province`), 68))\nlf.temp<- lf.temp[!(lf.temp$Province==\"\"),]\nlf.tc.freq<- aggregate(land.clean$TC.freq ~ land.clean$Year\n                       + land.clean$`Landfall Province` + \n                         land.clean$`Landfall Intensity Category`, land.clean, sum)\nnames(lf.tc.freq)<- c(\"Year\", \"Province\", \"Intensity\", \"tc.freq\")\nlf.tc.freq<- merge(lf.temp, lf.tc.freq, all=TRUE)\nlf.tc.freq[is.na(lf.tc.freq$tc.freq),]$tc.freq <- 0\nlf.tc.freq[is.na(lf.tc.freq$Intensity),]$Intensity <- 0\nlf.freq <- aggregate(land.clean$`Total Times of Landfall` ~ land.clean$Year\n                     + land.clean$`Landfall Province` + \n                       land.clean$`Landfall Intensity Category`, land.clean, sum)\nnames(lf.freq)<- c(\"Year\", \"Province\", \"Intensity\", \"lf.freq\")\nlf.freq<- merge(lf.temp, lf.freq, all=TRUE)\nlf.freq[is.na(lf.freq$lf.freq),]$lf.freq <- 0\nlf.freq[is.na(lf.freq$Intensity),]$Intensity <- 0\nlf.freq <- merge(lf.freq, lf.tc.freq, all = TRUE)\n\n\n## a.3 lf.annual.tc.numbers\nlf.tc.an.freq<- aggregate(lf.freq$tc.freq, \n                          by = list(Year=(lf.freq$Year)), \n                          FUN=sum)\nlf.tc.an.prov.freq<- aggregate(tc.freq ~ Year + Province, lf.freq, sum)\n## TS+\nlf.TS <- lf.freq[lf.freq$Intensity>=2,]\nlf.TS<- merge(lf.temp, lf.TS, all=TRUE)\nlf.TS[is.na(lf.TS)] <- 0\nlf.ts.an.freq<- aggregate(lf.TS$tc.freq,\n                          by = list(Year=(lf.TS$Year)),\n                          FUN=sum)\nlf.ts.an.prov.freq<-aggregate(tc.freq ~ Year + Province, lf.TS, sum)\n## TY+\nlf.TY <- lf.freq[lf.freq$Intensity>=4,]\nlf.TY<- merge(lf.temp, lf.TY, all=TRUE)\nlf.TY[is.na(lf.TY)] <- 0\nlf.ty.an.freq<- aggregate(lf.TY$tc.freq,\n                          by = list(Year=(lf.TY$Year)),\n                          FUN=sum)\nlf.ty.an.prov.freq<-aggregate(tc.freq ~ Year + Province, lf.TY, sum)\n## SuperTY+\nlf.SuperTY <- lf.freq[lf.freq$Intensity>=6,]\nlf.SuperTY<- merge(lf.temp, lf.SuperTY, all=TRUE)\nlf.SuperTY[is.na(lf.SuperTY)] <- 0\nlf.SuperTY.an.freq<- aggregate(lf.SuperTY$tc.freq,\n                          by = list(Year=(lf.SuperTY$Year)),\n                          FUN=sum)\nlf.SuperTY.an.prov.freq<-aggregate(tc.freq ~ Year + Province, lf.SuperTY, sum)\n\n## Combine into one dataframe\nDT.lf.tc<- data.frame(lf.tc.an.freq,lf.ts.an.freq$x, lf.ty.an.freq$x, lf.SuperTY.an.freq$x)\nnames(DT.lf.tc)<-c(\"Year\", \"ALL\", \"TS+\",\"TY+\",\"SuperTY\")\n\n\n## b. Plotting\n## b.1 Distribution\nplot.new()\npar(mfrow=c(2,2))\nplot(density(lf.tc.an.freq$x),\n     main = \"Kernel Density of annual TC numbers making landfalls, 1949-2016\",\n     cex.main=0.8)\nplot(density(lf.ts.an.freq$x),\n     main = \"Kernel Density of annual TS numbers making landfalls, 1949-2016\",\n     cex.main=0.8)\nplot(density(lf.ty.an.freq$x),\n     main = \"Kernel Density of annual Typhoon numbers making landfalls, 1949-2016\",\n     cex.main=0.8)\nplot(density(lf.SuperTY.an.freq$x),\n     main = \"Kernel Density of annual SuperTyphoon numbers making landfalls, 1949-2016\",\n     cex.main=0.8)\ndev.copy(pdf,\"Kernel Distribution of annual TC making lf.pdf\",width=8,height=6)\ndev.off()\npar(mfrow=c(1,1))\n## b.2 acf & pacf\nplot.new()\npar(mfrow=c(2,2))\nacf(lf.tc.an.freq$x,lag.max=20)\nacf(lf.ts.an.freq$x, lag.max = 20)\nacf(lf.ty.an.freq$x,lag.max=20)\nacf(lf.SuperTY.an.freq$x,lag.max=20)\ndev.copy(pdf,\"acf of annual TC making lf.pdf\",width=8,height=6)\ndev.off()\n# We can't say there's any evidance for the serial correlation\n# No significant autocorrelation at any lag\npar(mfrow=c(1,1))\n## b.3 Time Series plot\nplot.new()\nplot(lf.tc.an.freq$Year,lf.tc.an.freq$x,  xlab=\"Year\", ylab= \"Number of Tropical Cyclones making landfall\",\n     main=\"Annual Number of TC making landfall, 1949-2016\", type = \"l\")\nlo <- loess(lf.tc.an.freq$x ~ lf.tc.an.freq$Year)\nlines(lf.tc.an.freq$Year, lo$fitted, col=\"blue\")\ndev.copy(pdf,\"Annual Number of TC making landfall.pdf\",width=8,height=6)\ndev.off()\n## b.4 Categorized by intensity\nplot.new()\nDT.lf.tc %>%\n  gather(key,value,\"ALL\", \"TS+\" , \"TY+\", \"SuperTY\") %>%\n  ggplot(aes(x=Year, y=value, colour=key)) +\n  geom_line() + \n  ggtitle(\"Annual Number of TS+,TY+ and SuperTY, 1949-2016\") +\n  xlab(\"Year 1949-2016\") + ylab(\"Frequency\")+ \n  geom_smooth(method = \"loess\", se=FALSE,size = 1) +\n  theme(plot.title = element_text(size = rel(1.5)))\ndev.copy(pdf,\"ALL_TC_Freq_by_Int lf.pdf\",width=8,height=6)\ndev.off()\n\n## b.5 By province - xyplot\nplot.new()\nxyplot(lf.freq$tc.freq ~ lf.freq$Year | lf.freq$Province, \n       type=\"l\",xlab=\"Year\",ylab=\"Total times of TC making landfall\",\n       main=\"Annual Frequency of TC making landfall for different provinces\")\ndev.copy(pdf,\"Frequency of TC_provinces.pdf\",width=8,height=6)\ndev.off()\nplot.new()\nxyplot(lf.ts.an.prov.freq$tc.freq ~ lf.ts.an.prov.freq$Year| lf.ts.an.prov.freq$Province,\n       type=\"l\",xlab=\"Year\",ylab=\"Total times of TS making landfall\",\n       main=\"Annual Frequency of TS making landfall for different provinces\")\ndev.copy(pdf,\"Frequency of TS_provinces.pdf\",width=8,height=6)\ndev.off()\nplot.new()\nxyplot(lf.ty.an.prov.freq$tc.freq ~ lf.ty.an.prov.freq$Year| lf.ty.an.prov.freq$Province,\n       type=\"l\",xlab=\"Year\",ylab=\"Total times of TY making landfall\",\n       main=\"Annual Frequency of TY making landfall for different provinces\")\ndev.copy(pdf,\"Frequency of TY_provinces.pdf\",width=8,height=6)\ndev.off()\nplot.new()\nxyplot(lf.SuperTY.an.prov.freq$tc.freq ~ lf.SuperTY.an.prov.freq$Year| lf.SuperTY.an.prov.freq$Province,\n       type=\"l\",xlab=\"Year\",ylab=\"Total times of SuperTY making landfall\",\n       main=\"Annual Frequency of SuperTY making landfall for different provinces\")\ndev.copy(pdf,\"Frequency of SuperTY_provinces.pdf\",width=8,height=6)\ndev.off()\n## b.6 By Province - ALL TC\n## Total Landfall\nlf.tc.an.prov.freq$od.prov<-reorder(lf.tc.an.prov.freq$Province, lf.tc.an.prov.freq$tc.freq)\nplot.new()\np <-  ggplot(data=lf.tc.an.prov.freq, aes(od.prov, Year)) + \n  geom_tile(aes(fill = tc.freq), colour = \"white\") +\n  scale_fill_gradient(low = \"#FFFF80CC\",high = \"#FF0000CC\")+\n  labs(x = \"Provinces\",y = \"Year\", title = \"Annual Frequency of TC making Landfall 1949-2016 by Provinces\")\n\np + theme(plot.title = element_text(size = rel(1.2))) + theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = \"grey50\"))\ndev.copy(pdf,\"Heatmap_TC_prov_total.pdf\",width=8,height=6)\ndev.off()\n\n## TS+\nlf.ts.an.prov.freq$od.prov<-reorder(lf.ts.an.prov.freq$Province, lf.ts.an.prov.freq$tc.freq)\nplot.new()\np1 <-  ggplot(data=lf.ts.an.prov.freq, aes(od.prov, Year)) + \n  geom_tile(aes(fill = tc.freq), colour = \"white\") +\n  scale_fill_gradient(low = \"#FFFF80CC\",high = \"#FF0000CC\")+\n  labs(x = \"Provinces\",y = \"Year\", title = \"Annual Frequency of Tropical Storms making Landfall 1949-2016 by Provinces\")\n\np1 + theme(plot.title = element_text(size = rel(1.2))) + theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = \"grey50\"))\ndev.copy(pdf,\"Heatmap_TS_prov.pdf\",width=8,height=6)\ndev.off()\n## TY+\nlf.ty.an.prov.freq$od.prov<-reorder(lf.ty.an.prov.freq$Province, lf.ty.an.prov.freq$tc.freq)\nplot.new()\np2 <-  ggplot(data=lf.ty.an.prov.freq, aes(od.prov, Year)) + \n  geom_tile(aes(fill = tc.freq), colour = \"white\") +\n  scale_fill_gradient(low = \"#FFFF80CC\",high = \"#FF0000CC\")+\n  labs(x = \"Provinces\",y = \"Year\", title = \"Annual Frequency of Typhoons making Landfall 1949-2016 by Provinces\")\n\np2 + theme(plot.title = element_text(size = rel(1.2))) + theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = \"grey50\"))\ndev.copy(pdf,\"Heatmap_TY_prov.pdf\",width=8,height=6)\ndev.off()\n## SuperTY\nlf.SuperTY.an.prov.freq$od.prov<-reorder(lf.SuperTY.an.prov.freq$Province, lf.SuperTY.an.prov.freq$tc.freq)\nplot.new()\np3 <-  ggplot(data=lf.SuperTY.an.prov.freq, aes(od.prov, Year)) + \n  geom_tile(aes(fill = tc.freq), colour = \"white\") +\n  scale_fill_gradient(low = \"#FFFF80CC\",high = \"#FF0000CC\")+\n  labs(x = \"Provinces\",y = \"Year\", title = \"Annual Frequency of Super Typhoons making Landfall 1949-2016 by Provinces\")\n\np3 + theme(plot.title = element_text(size = rel(1.2))) + theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = \"grey50\"))\ndev.copy(pdf,\"Heatmap_SuperTY_prov.pdf\",width=8,height=6)\ndev.off()\n\n## Part 2: CMABST Data\n## 1. Reconstructing Data\n\nBST.temp <- data.frame(Year=rep(1949:2016, each=12), \n                       Month= rep(c(\"01\",\"02\",\"03\",\"04\",\"05\",\"06\",\"07\",\"08\",\"09\",\"10\",\"11\",\"12\"), 68))\nBST.clean<- CMABST\nBST.clean[BST.clean$Intensity==9,]$Intensity <- 0\nBST.freq <- data.frame(Year=BST.clean$Year,\n                       Month=BST.clean$Month,\n                       Intensity = BST.clean$Intensity,\n                       SN=substr(BST.clean$SerialNum, 6,7))\n## maximum Intensity\nBST.SN.freq<- aggregate(Intensity ~ SN + Year, BST.freq, max)\nBST.SN.freq$freq<- rep(1, length(BST.SN.freq$Year))\nBST.freq<- aggregate(Intensity ~ SN + Year + Month, BST.freq, max)\nBST.freq$freq <- rep(1, length(BST.freq$Year))\nBST.freq<- merge(BST.temp, BST.freq, all=TRUE)\nBST.freq[is.na(BST.freq$freq),]$freq <- 0\nBST.freq[is.na(BST.freq$Intensity),]$Intensity <- 0\nBST.freq$SN <- as.numeric(as.character(BST.freq$SN))\nBST.freq[is.na(BST.freq$SN),]$SN <- 0\n## annual frequency TC and monthly TC\nBST.an.freq<- aggregate(BST.freq$SN, by=list(Year=BST.freq$Year), max)\nnames(BST.an.freq)<- c(\"Year\", \"Frequency\")\nBST.an.mon.freq<- aggregate(freq ~ Year + Month, BST.freq,sum)\nBST.mon.freq<- aggregate(BST.freq$freq, by=list(Month=BST.freq$Month), sum)\nBST.mon.freq$Month<- as.numeric(levels(BST.mon.freq$Month))\n## TS+\nBST.TS <- BST.freq[BST.freq$Intensity>=2,]\nBST.SN.TS<- BST.SN.freq[BST.SN.freq$Intensity>=2,]\nBST.TS<- merge(BST.TS, BST.temp, all=TRUE)\nBST.TS[is.na(BST.TS$freq),]$freq <- 0\nBST.TS[is.na(BST.TS$Intensity),]$Intensity <- 0\nBST.an.TS<- aggregate(BST.SN.TS$freq, by= list(Year=(BST.SN.TS$Year)), FUN=sum)\nBST.mon.TS<- aggregate(freq ~ Year + Month, BST.TS, sum)\n## TY+\nBST.TY <- BST.freq[BST.freq$Intensity>=4,]\nBST.SN.TY<- BST.SN.freq[BST.SN.freq$Intensity>=4,]\nBST.TY<- merge(BST.TY, BST.temp, all=TRUE)\nBST.TY[is.na(BST.TY$freq),]$freq <- 0\nBST.TY[is.na(BST.TY$Intensity),]$Intensity <- 0\nBST.an.TY<- aggregate(BST.SN.TY$freq, by= list(Year=(BST.SN.TY$Year)), FUN=sum)\nBST.mon.TY<- aggregate(freq ~ Year + Month, BST.TY, sum)\n## SuperTY\nBST.SuperTY <- BST.freq[BST.freq$Intensity>=6,]\nBST.SN.SuperTY<- BST.SN.freq[BST.SN.freq$Intensity>=6,]\nBST.SuperTY<- merge(BST.SuperTY, BST.temp, all=TRUE)\nBST.SuperTY[is.na(BST.SuperTY$freq),]$freq <- 0\nBST.SuperTY[is.na(BST.SuperTY$Intensity),]$Intensity <- 0\nBST.an.SuperTY<- aggregate(BST.SN.SuperTY$freq, by= list(Year=(BST.SN.SuperTY$Year)), FUN=sum)\nSuTY1999<- data.frame(Year=1999, x=0)\nBST.an.SuperTY<-rbind(BST.an.SuperTY, SuTY1999)\nBST.mon.SuperTY<- aggregate(freq ~ Year + Month, BST.SuperTY, sum)\n\n## Combine\nDT.BST.an<- data.frame(BST.an.freq, BST.an.TS$x, BST.an.TY$x, BST.an.SuperTY$x)\nnames(DT.BST.an)<-c(\"Year\",\"ALL\", \"TS+\",\"TY+\",\"SuperTY\")\n\n\n## b. plot\nplot.new()\n## b.1 Seasonality\nplot(BST.mon.freq$Month,BST.mon.freq$x, type=\"l\",\n     main = \"Frequency of monthly TC numbers, 1949-2016\",\n     xlab= \"Month\",\n     ylab = \"Frequency\")\ndev.copy(pdf,\"Seasonality of TC NWP.pdf\",width=8,height=6)\ndev.off()\n## b.2 Distribution of annual TC numbers, 1949-2016\nplot.new()\npar(mfrow=c(2,2))\nplot(density(BST.an.freq$Frequency),\n     main=\"Kernel Density of annual TC in Northwestern Pacific basin, 1949-2016\"\n     ,cex.main =0.8)\nplot(density(BST.an.TS$x),\n     main=\"Kernel Density of annual TS+ in Northwestern Pacific basin, 1949-2016\"\n     ,cex.main =0.8)\nplot(density(BST.an.TY$x),\n     main=\"Kernel Density of annual TY+ in Northwestern Pacific basin, 1949-2016\"\n     ,cex.main =0.8)\nplot(density(BST.an.SuperTY$x),\n     main=\"Kernel Density of annual SuperTY in Northwestern Pacific basin, 1949-2016\"\n     ,cex.main =0.8)\ndev.copy(pdf,\"Kernel Distribution of annual TC in NWP.pdf\",width=8,height=6)\ndev.off()\n## b.3 ACF PACF\npar(mfrow=c(2,2))\nacf(BST.an.freq$Frequency,lag.max=20)  # Strong lag\nacf(BST.an.TS$x, lag.max = 20)\nacf(BST.an.TY$x,lag.max=20)\nacf(BST.an.SuperTY$x,lag.max=20)\ndev.copy(pdf,\"NWP_ACF.pdf\",width=8,height=6)\ndev.off()\npar(mfrow=c(1,1))\n## b.4 Time Series Plot\nplot.new()\nplot(BST.an.freq$Year,BST.an.freq$Frequency,  \n     xlab=\"Year\", \n     ylab= \"Total times of TC\",\n     main=\"Annual Number of TC in NWP, 1949-2016\", type = \"l\")\nlo <- loess(BST.an.freq$Frequency ~ BST.an.freq$Year)\nlines(BST.an.freq$Year, lo$fitted, col=\"blue\")\ndev.copy(pdf,\"total times of TC in NWP by year.pdf\",width=8,height=6)\ndev.off()\n## Categorize by intensity\nplot.new()\nDT.BST.an %>%\n  gather(key,value, \"TS+\" , \"TY+\", \"SuperTY\") %>%\n  ggplot(aes(x=Year, y=value, colour=key)) +\n  geom_line() + \n  ggtitle(\"Annual Number of TS+,TY+ and SuperTY in NWP, 1949-2016\") +\n  xlab(\"Year 1949-2016\") + ylab(\"Frequency\")+ \n  geom_smooth(method = \"loess\", se=FALSE,size = 1) +\n  theme(plot.title = element_text(size = rel(1.5)))\ndev.copy(pdf,\"BST_NWP_Freq_Int by year.pdf\",width=8,height=6)\ndev.off()\n\n## By month\nplot.new()\nxyplot(BST.an.mon.freq$freq ~ BST.an.mon.freq$Year | BST.an.mon.freq$Month, \n       type=\"l\",xlab=\"Year\",ylab=\"Total times of Tropical Cyclones\",\n       main=\"Annual Frequency of TC for different months\")\ndev.copy(pdf,\"Frequency of TC_months.pdf\",width=8,height=6)\ndev.off()\nplot.new()\nxyplot(BST.mon.TS$freq ~ BST.mon.TS$Year | BST.mon.TS$Month, \n       type=\"l\",xlab=\"Year\",ylab=\"Total times of Tropical Storms\",\n       main=\"Annual Frequency of TS for different months\")\ndev.copy(pdf,\"Frequency of TS_months.pdf\",width=8,height=6)\ndev.off()\nplot.new()\nxyplot(BST.mon.TY$freq ~ BST.mon.TY$Year | BST.mon.TY$Month, \n       type=\"l\",xlab=\"Year\",ylab=\"Total times of Typhoons\",\n       main=\"Annual Frequency of TY for different months\")\ndev.copy(pdf,\"Frequency of TY_months.pdf\",width=8,height=6)\ndev.off()\nplot.new()\nxyplot(BST.mon.SuperTY$freq ~ BST.mon.SuperTY$Year | BST.mon.SuperTY$Month, \n       type=\"l\",xlab=\"Year\",ylab=\"Total times of Super Typhoons\",\n       main=\"Annual Frequency of SuperTY for different months\")\ndev.copy(pdf,\"Frequency of SuperTY_months.pdf\",width=8,height=6)\ndev.off()\n\n## Part 4: Heatmap\n## Total TC _ By months\nBST.an.mon.freq$od.prov<-reorder(BST.an.mon.freq$Month, BST.an.mon.freq$freq)\nplot.new()\np <-  ggplot(data=BST.an.mon.freq, aes(od.prov, Year)) + \n  geom_tile(aes(fill = freq), colour = \"white\") +\n  scale_fill_gradient(low = \"#FFFF80CC\",high = \"#FF0000CC\")+\n  labs(x = \"Months\",y = \"Year\", title = \"Annual Frequency of Tropical Cyclones in 1949-2016 of different months\")\n\np + theme(plot.title = element_text(size = rel(1.2))) + theme(axis.text.x = element_text(hjust = 1, colour = \"grey50\"))\ndev.copy(pdf,\"Heatmap_TC_total.pdf\",width=8,height=6)\ndev.off()\n\n## TS+\nBST.mon.TS$od.prov<-reorder(BST.mon.TS$Month, BST.mon.TS$freq)\nplot.new()\np1 <-  ggplot(data=BST.mon.TS, aes(od.prov, Year)) + \n  geom_tile(aes(fill = freq), colour = \"white\") +\n  scale_fill_gradient(low = \"#FFFF80CC\",high = \"#FF0000CC\")+\n  labs(x = \"Months\",y = \"Year\", title = \"Annual Frequency of Tropical Storms in 1949-2016 of different months\")\n\np1 + theme(plot.title = element_text(size = rel(1.2))) + theme(axis.text.x = element_text(hjust = 1, colour = \"grey50\"))\ndev.copy(pdf,\"Heatmap_TS_total.pdf\",width=8,height=6)\ndev.off()\n\n## TY+\nBST.mon.TY$od.prov<-reorder(BST.mon.TY$Month, BST.mon.TY$freq)\nplot.new()\np2 <-  ggplot(data=BST.mon.TY, aes(od.prov, Year)) + \n  geom_tile(aes(fill = freq), colour = \"white\") +\n  scale_fill_gradient(low = \"#FFFF80CC\",high = \"#FF0000CC\")+\n  labs(x = \"Months\",y = \"Year\", title = \"Annual Frequency of Typhoons in 1949-2016 of different months\")\n\np2 + theme(plot.title = element_text(size = rel(1.2))) + theme(axis.text.x = element_text(hjust = 1, colour = \"grey50\"))\ndev.copy(pdf,\"Heatmap_TY_total.pdf\",width=8,height=6)\ndev.off()\n\n## SuperTyphoon\nBST.mon.SuperTY$od.prov<-reorder(BST.mon.SuperTY$Month, BST.mon.SuperTY$freq)\nplot.new()\np3 <-  ggplot(data=BST.mon.SuperTY, aes(od.prov, Year)) + \n  geom_tile(aes(fill = freq), colour = \"white\") +\n  scale_fill_gradient(low = \"#FFFF80CC\",high = \"#FF0000CC\")+\n  labs(x = \"Months\",y = \"Year\", title = \"Annual Frequency of SuperTyphoons in 1949-2016 of different months\")\n\np3 + theme(plot.title = element_text(size = rel(1.2))) + theme(axis.text.x = element_text(hjust = 1, colour = \"grey50\"))\ndev.copy(pdf,\"Heatmap_SuperTyphoon_total.pdf\",width=8,height=6)\ndev.off()\n\n## By year\nBST.an.mon.freq$od.year<-reorder(BST.an.mon.freq$Year, BST.an.mon.freq$freq)\nplot.new()\np4 <-  ggplot(data=BST.an.mon.freq, aes(od.year, Month)) + \n  geom_tile(aes(fill = freq), colour = \"white\") +\n  scale_fill_gradient(low = \"#FFFF80CC\",high = \"#FF0000CC\")+\n  labs(x = \"Year\",y = \"Month\", title = \"Annual Frequency of Tropical Cyclones in 1949-2016\")\n\np4 + theme(plot.title = element_text(size = rel(1.2))) + theme(axis.text.x = element_text(angle = 90,hjust = 1, colour = \"grey50\"))\ndev.copy(pdf,\"Heatmap_TC_total_Year.pdf\",width=8,height=6)\ndev.off()\n\n## TS+\nBST.mon.TS$od.year<-reorder(BST.mon.TS$Year, BST.mon.TS$freq)\nplot.new()\np5 <-  ggplot(data=BST.mon.TS, aes(od.year, Month)) + \n  geom_tile(aes(fill = freq), colour = \"white\") +\n  scale_fill_gradient(low = \"#FFFF80CC\",high = \"#FF0000CC\")+\n  labs(x = \"Year\",y = \"Month\", title = \"Annual Frequency of Tropical Storms in 1949-2016\")\n\np5 + theme(plot.title = element_text(size = rel(1.2))) + theme(axis.text.x = element_text(angle = 90,hjust = 1, colour = \"grey50\"))\ndev.copy(pdf,\"Heatmap_TS_total_Year.pdf\",width=8,height=6)\ndev.off()\n\n## TY+\nBST.mon.TY$od.year<-reorder(BST.mon.TY$Year, BST.mon.TY$freq)\nplot.new()\np6 <-  ggplot(data=BST.mon.TY, aes(od.year, Month)) + \n  geom_tile(aes(fill = freq), colour = \"white\") +\n  scale_fill_gradient(low = \"#FFFF80CC\",high = \"#FF0000CC\")+\n  labs(x = \"Year\",y = \"Month\", title = \"Annual Frequency of Typhoons in 1949-2016\")\n\np6 + theme(plot.title = element_text(size = rel(1.2))) + theme(axis.text.x = element_text(angle = 90,hjust = 1, colour = \"grey50\"))\ndev.copy(pdf,\"Heatmap_TY_total_Year.pdf\",width=8,height=6)\ndev.off()\n\n## SuperTY\nBST.mon.SuperTY$od.year<-reorder(BST.mon.SuperTY$Year, BST.mon.SuperTY$freq)\nplot.new()\np7 <-  ggplot(data=BST.mon.SuperTY, aes(od.year, Month)) + \n  geom_tile(aes(fill = freq), colour = \"white\") +\n  scale_fill_gradient(low = \"#FFFF80CC\",high = \"#FF0000CC\")+\n  labs(x = \"Year\",y = \"Month\", title = \"Annual Frequency of SuperTY in 1949-2016\")\n\np7 + theme(plot.title = element_text(size = rel(1.2))) + theme(axis.text.x = element_text(angle = 90,hjust = 1, colour = \"grey50\"))\ndev.copy(pdf,\"Heatmap_SuperTY_total_Year.pdf\",width=8,height=6)\ndev.off()\n",
    "created" : 1509841833726.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1147701982",
    "id" : "6D5FA1AC",
    "lastKnownWriteTime" : 1510579470,
    "last_content_update" : 1510579470384,
    "path" : "E:/UCL_Study/Project_typhoon/STAT3901 Project/Step2-2_Exp Stats_time series_ver2.0_lf.tc.R",
    "project_path" : "Step2-2_Exp Stats_time series_ver2.0_lf.tc.R",
    "properties" : {
        "tempName" : "Untitled4"
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}